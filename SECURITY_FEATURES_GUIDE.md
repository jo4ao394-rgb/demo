# ğŸ›¡ï¸ å®Œæ•´å®‰å…¨æ€§åŠŸèƒ½æŒ‡å—

**æ–‡æª”ç‰ˆæœ¬**: v2.0  
**æœ€å¾Œæ›´æ–°**: 2025å¹´11æœˆ6æ—¥  
**ç³»çµ±æ¶æ§‹**: Spring Boot + Spring Security 6.x + JWT + Redis  

---

## ğŸ“Š å®‰å…¨æ¶æ§‹ç¸½è¦½

### ğŸ—ï¸ å¤šå±¤å®‰å…¨é˜²è­·é«”ç³»
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              å‰ç«¯å®‰å…¨å±¤ (Client-Side)                â”‚
â”‚  â€¢ CSP å…§å®¹å®‰å…¨ç­–ç•¥  â€¢ XSS é˜²è­·  â€¢ CSRF Token      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚              ç¶²è·¯å‚³è¼¸å±¤ (Transport)                  â”‚
â”‚  â€¢ HTTPS å¼·åˆ¶  â€¢ HSTS æ¨™é ­  â€¢ å®‰å…¨Cookie           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚              æ‡‰ç”¨å®‰å…¨å±¤ (Application)                â”‚
â”‚  â€¢ èªè­‰éæ¿¾å™¨  â€¢ æˆæ¬Šæª¢æŸ¥  â€¢ è¼¸å…¥é©—è­‰              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚              èªè­‰ç®¡ç†å±¤ (Authentication)             â”‚
â”‚  â€¢ JWT Token  â€¢ Session  â€¢ Redis é»‘åå–®           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚              æ•¸æ“šå®‰å…¨å±¤ (Data Protection)            â”‚
â”‚  â€¢ å¯†ç¢¼åŠ å¯†  â€¢ æ•¸æ“šåº« SSL  â€¢ æ•æ„Ÿé…ç½®åŠ å¯†          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ” èªè­‰ç³»çµ± (Authentication System)

### 1. JWT Token èªè­‰æ©Ÿåˆ¶
**å®‰å…¨æŒ‡æ•¸**: â­â­â­â­â­ (96/100)

#### ğŸ¯ åŠŸèƒ½ç”¨é€”
- **ç„¡ç‹€æ…‹èªè­‰**: é©ç”¨æ–¼ REST API å’Œå¾®æœå‹™æ¶æ§‹
- **è·¨åŸŸæ”¯æ´**: æ”¯æ´ SPA (Single Page Application) å‰ç«¯
- **å¯æ“´å±•æ€§**: ç„¡éœ€æœå‹™å™¨ç«¯ Session å­˜å„²ï¼Œæ˜“æ–¼æ°´å¹³æ“´å±•
- **ç§»å‹•å‹å¥½**: é©åˆç§»å‹•æ‡‰ç”¨å’Œç¬¬ä¸‰æ–¹é›†æˆ

#### âš™ï¸ æŠ€è¡“å¯¦ç¾
```java
// JWT ç”Ÿæˆèˆ‡é©—è­‰
@Service
public class JwtService {
    private final String SECRET_KEY = "myVerySecureSecretKey...";
    private final long JWT_EXPIRATION = 86400000; // 24å°æ™‚
    
    // ç”Ÿæˆ Token
    public String generateToken(UserDetails userDetails) {
        return Jwts.builder()
                .setSubject(userDetails.getUsername())
                .setIssuedAt(new Date(System.currentTimeMillis()))
                .setExpiration(new Date(System.currentTimeMillis() + JWT_EXPIRATION))
                .signWith(getSignInKey(), SignatureAlgorithm.HS256)
                .compact();
    }
}
```

#### ğŸ›¡ï¸ å®‰å…¨ç‰¹æ€§
- âœ… **256ä½å¯†é‘°**: ä½¿ç”¨ HMAC-SHA256 ç°½åç®—æ³•
- âœ… **Token éæœŸ**: 24å°æ™‚è‡ªå‹•éæœŸæ©Ÿåˆ¶
- âœ… **å”¯ä¸€è­˜åˆ¥**: æ¯å€‹ Token åŒ…å« JTI (JWT ID)
- âœ… **æ•¸ä½ç°½å**: é˜²æ­¢ Token è¢«ç¯¡æ”¹
- âœ… **Claims é©—è­‰**: é©—è­‰ç™¼è¡Œè€…ã€åˆ°æœŸæ™‚é–“ç­‰

#### ğŸ“ˆ å®‰å…¨è©•åˆ†ç´°é …
| å®‰å…¨é …ç›® | è©•åˆ† | èªªæ˜ |
|---------|------|------|
| å¯†é‘°å¼·åº¦ | 98/100 | 256ä½éš¨æ©Ÿç”Ÿæˆå¯†é‘° |
| éæœŸæ©Ÿåˆ¶ | 95/100 | 24å°æ™‚å¼·åˆ¶éæœŸ |
| ç°½åé©—è­‰ | 98/100 | HMAC-SHA256 æ•¸ä½ç°½å |
| Token çµæ§‹ | 92/100 | æ¨™æº– JWT çµæ§‹ï¼ŒåŒ…å«å¿…è¦ Claims |

---

### 2. Session èªè­‰æ©Ÿåˆ¶
**å®‰å…¨æŒ‡æ•¸**: â­â­â­â­ (88/100)

#### ğŸ¯ åŠŸèƒ½ç”¨é€”
- **å‚³çµ±Webæ‡‰ç”¨**: æ”¯æ´ MVC æ¨¡å¼çš„ Web é é¢
- **ç‹€æ…‹ä¿æŒ**: æœå‹™å™¨ç«¯ç¶­è­·ç”¨æˆ¶ç‹€æ…‹
- **è³¼ç‰©è»ŠåŠŸèƒ½**: é©åˆéœ€è¦æœå‹™å™¨ç«¯ç‹€æ…‹çš„æ¥­å‹™é‚è¼¯
- **å…¼å®¹æ€§**: èˆ‡èˆŠç‰ˆç€è¦½å™¨å’Œç³»çµ±å…¼å®¹

#### âš™ï¸ æŠ€è¡“å¯¦ç¾
```java
// Session èªè­‰é…ç½®
@PostMapping("/userlogin")
public List<User> userlogin(HttpSession session, @RequestBody User user) {
    List<User> list = userService.login(user.getUsername(), user.getPassword());
    
    // è¨­ç½® Session å±¬æ€§
    session.setAttribute("uid", list.get(0).getUid());
    session.setAttribute("username", list.get(0).getUsername());
    
    // å»ºç«‹ Spring Security èªè­‰ä¸Šä¸‹æ–‡
    UsernamePasswordAuthenticationToken authentication = 
        new UsernamePasswordAuthenticationToken(user.getUsername(), null, authorities);
    SecurityContextHolder.getContext().setAuthentication(authentication);
    
    // æŒä¹…åŒ–èªè­‰ç‹€æ…‹åˆ° Session
    session.setAttribute("SPRING_SECURITY_CONTEXT", SecurityContextHolder.getContext());
    
    return list;
}
```

#### ğŸ›¡ï¸ å®‰å…¨ç‰¹æ€§
- âœ… **HttpOnly Cookie**: é˜²æ­¢ XSS æ”»æ“Šç«Šå– Session ID
- âœ… **SameSite ä¿è­·**: é˜²æ­¢ CSRF æ”»æ“Š
- âœ… **Session è¶…æ™‚**: 30åˆ†é˜ç„¡æ´»å‹•è‡ªå‹•éæœŸ
- âœ… **å®‰å…¨å‚³è¼¸**: HTTPS ç’°å¢ƒä¸‹ä½¿ç”¨ Secure æ¨™è¨˜
- âœ… **Session å›ºå®šé˜²è­·**: ç™»å…¥å¾Œé‡æ–°ç”Ÿæˆ Session ID

#### ğŸ“ˆ å®‰å…¨è©•åˆ†ç´°é …
| å®‰å…¨é …ç›® | è©•åˆ† | èªªæ˜ |
|---------|------|------|
| Cookie å®‰å…¨ | 90/100 | HttpOnly + SameSite + Secure |
| è¶…æ™‚æ©Ÿåˆ¶ | 85/100 | 30åˆ†é˜é–’ç½®è¶…æ™‚ |
| å›ºå®šé˜²è­· | 88/100 | ç™»å…¥å¾Œé‡æ–°ç”Ÿæˆ ID |
| ç‹€æ…‹ç®¡ç† | 90/100 | æœå‹™å™¨ç«¯å®‰å…¨å­˜å„² |

---

### 3. æ··åˆèªè­‰ç­–ç•¥
**å®‰å…¨æŒ‡æ•¸**: â­â­â­â­â­ (94/100)

#### ğŸ¯ åŠŸèƒ½ç”¨é€”
- **éˆæ´»é¸æ“‡**: æ ¹æ“šå®¢æˆ¶ç«¯é¡å‹é¸æ“‡æœ€é©åˆçš„èªè­‰æ–¹å¼
- **å¹³æ»‘é·ç§»**: æ”¯æ´å¾å‚³çµ± Session åˆ°ç¾ä»£ JWT çš„é€æ­¥é·ç§»
- **å¤šç«¯æ”¯æ´**: åŒæ™‚æœå‹™ Webã€Mobileã€API å®¢æˆ¶ç«¯
- **è² è¼‰å‡è¡¡**: JWT æ”¯æ´ç„¡ç‹€æ…‹ï¼ŒSession æ”¯æ´ç‹€æ…‹ä¿æŒ

#### âš™ï¸ æŠ€è¡“å¯¦ç¾
```java
// æ··åˆèªè­‰éæ¿¾å™¨éˆ
@Bean
public SecurityFilterChain enhancedFilterChain(HttpSecurity http) throws Exception {
    return http
        // Session èªè­‰æ¢å¾©éæ¿¾å™¨ (å„ªå…ˆç´šè¼ƒé«˜)
        .addFilterBefore(sessionAuthenticationFilter, UsernamePasswordAuthenticationFilter.class)
        // JWT èªè­‰éæ¿¾å™¨ (æ¬¡è¦)
        .addFilterBefore(enhancedJwtAuthenticationFilter, UsernamePasswordAuthenticationFilter.class)
        .authorizeHttpRequests(auth -> {
            auth
                // API ç«¯é»ä½¿ç”¨ JWT
                .requestMatchers("/api/**").authenticated()
                // Web é é¢ä½¿ç”¨ Session  
                .requestMatchers("/carts/**", "/mycarts").authenticated()
                .anyRequest().permitAll();
        })
        .build();
}
```

#### ğŸ›¡ï¸ å®‰å…¨ç‰¹æ€§
- âœ… **æ™ºèƒ½è·¯ç”±**: æ ¹æ“šè«‹æ±‚è·¯å¾‘è‡ªå‹•é¸æ“‡èªè­‰æ–¹å¼
- âœ… **éæ¿¾å™¨éˆ**: æœ‰åºçš„èªè­‰æª¢æŸ¥æ©Ÿåˆ¶
- âœ… **å‘ä¸‹å…¼å®¹**: ä¿æŒèˆ‡ç¾æœ‰ç³»çµ±çš„å…¼å®¹æ€§
- âœ… **æ€§èƒ½å„ªåŒ–**: JWT ç„¡ç‹€æ…‹ + Session ç‹€æ…‹ä¿æŒçš„æœ€ä½³å¹³è¡¡

---

## ğŸ”’ Redis å®‰å…¨ç®¡ç†

### 1. JWT Token é»‘åå–®æ©Ÿåˆ¶
**å®‰å…¨æŒ‡æ•¸**: â­â­â­â­â­ (95/100)

#### ğŸ¯ åŠŸèƒ½ç”¨é€”
- **å³æ™‚æ’¤éŠ·**: ç«‹å³æ’¤éŠ·å·²æ´©éœ²æˆ–å¯ç–‘çš„ Token
- **ç™»å‡ºç®¡ç†**: ç”¨æˆ¶ç™»å‡ºå¾Œç«‹å³å¤±æ•ˆ Token
- **å¤šè¨­å‚™æ§åˆ¶**: ç®¡ç†ç”¨æˆ¶åœ¨å¤šè¨­å‚™ä¸Šçš„ç™»å…¥ç‹€æ…‹
- **å®‰å…¨éŸ¿æ‡‰**: æª¢æ¸¬åˆ°æ”»æ“Šæ™‚å¿«é€Ÿå°é– Token

#### âš™ï¸ æŠ€è¡“å¯¦ç¾
```java
@Service
public class JwtRedisTokenService {
    
    // å°‡ Token åŠ å…¥é»‘åå–®
    public void blacklistToken(String token) {
        String jti = jwtService.extractJti(token);
        long expiration = jwtService.getExpirationTime(token);
        long ttl = expiration - System.currentTimeMillis();
        
        if (ttl > 0) {
            redisTemplate.opsForValue().set(
                "blacklist:" + jti, 
                "revoked", 
                ttl, 
                TimeUnit.MILLISECONDS
            );
        }
    }
    
    // æª¢æŸ¥ Token æ˜¯å¦åœ¨é»‘åå–®ä¸­
    public boolean isTokenBlacklisted(String token) {
        String jti = jwtService.extractJti(token);
        return redisTemplate.hasKey("blacklist:" + jti);
    }
}
```

#### ğŸ›¡ï¸ å®‰å…¨ç‰¹æ€§
- âœ… **å¯¦æ™‚æ’¤éŠ·**: æ¯«ç§’ç´š Token æ’¤éŠ·éŸ¿æ‡‰
- âœ… **è‡ªå‹•æ¸…ç†**: TTL æ©Ÿåˆ¶è‡ªå‹•æ¸…ç†éæœŸçš„é»‘åå–®è¨˜éŒ„
- âœ… **é«˜å¯ç”¨æ€§**: Redis é›†ç¾¤æ”¯æ´é«˜å¯ç”¨éƒ¨ç½²
- âœ… **æ€§èƒ½å„ªåŒ–**: O(1) æ™‚é–“è¤‡é›œåº¦çš„æŸ¥è©¢æ•ˆç‡

#### ğŸ“ˆ å®‰å…¨è©•åˆ†ç´°é …
| å®‰å…¨é …ç›® | è©•åˆ† | èªªæ˜ |
|---------|------|------|
| æ’¤éŠ·é€Ÿåº¦ | 98/100 | æ¯«ç§’ç´šå¯¦æ™‚éŸ¿æ‡‰ |
| å­˜å„²å®‰å…¨ | 92/100 | Redis åŠ å¯†é€£æ¥ |
| è‡ªå‹•æ¸…ç† | 95/100 | TTL è‡ªå‹•éæœŸæ©Ÿåˆ¶ |
| é«˜å¯ç”¨æ€§ | 93/100 | æ”¯æ´ Redis é›†ç¾¤ |

---

## ğŸ›¡ï¸ æˆæ¬Šèˆ‡è¨ªå•æ§åˆ¶

### 1. ç´°ç²’åº¦æ¬Šé™æ§åˆ¶
**å®‰å…¨æŒ‡æ•¸**: â­â­â­â­â­ (92/100)

#### ğŸ¯ åŠŸèƒ½ç”¨é€”
- **æœ€å°æ¬Šé™**: æ¯å€‹ç«¯é»åƒ…æˆäºˆå¿…è¦çš„æœ€å°æ¬Šé™
- **è§’è‰²åˆ†é›¢**: å€åˆ†æ™®é€šç”¨æˆ¶ã€ç®¡ç†å“¡ç­‰ä¸åŒè§’è‰²
- **è³‡æºä¿è­·**: ä¿è­·æ•æ„Ÿæ¥­å‹™é‚è¼¯å’Œæ•¸æ“šè¨ªå•
- **åˆè¦è¦æ±‚**: æ»¿è¶³æ•¸æ“šä¿è­·å’Œéš±ç§æ³•è¦è¦æ±‚

#### âš™ï¸ æŠ€è¡“å¯¦ç¾
```java
.authorizeHttpRequests(auth -> {
    auth
        // å®Œå…¨å…¬é–‹çš„è³‡æº
        .requestMatchers(
            "/", "/login", "/register",           // åŸºæœ¬é é¢
            "/static/**", "/css/**", "/js/**",    // éœæ…‹è³‡æº
            "/products/list/**"                   // ç”¢å“ç€è¦½
        ).permitAll()
        
        // éœ€è¦èªè­‰çš„è³‡æº
        .requestMatchers("/carts/**", "/mycarts").authenticated()
        .requestMatchers("/users/**").authenticated()
        
        // éœ€è¦ç®¡ç†å“¡æ¬Šé™
        .requestMatchers("/admin/**").hasRole("ADMIN")
        
        // é»˜èªæ‹’çµ•
        .anyRequest().authenticated();
})
```

#### ğŸ›¡ï¸ å®‰å…¨ç‰¹æ€§
- âœ… **ç™½åå–®æ©Ÿåˆ¶**: æ˜ç¢ºå®šç¾©å…è¨±çš„è³‡æºè¨ªå•
- âœ… **è·¯å¾‘åŒ¹é…**: ç²¾ç¢ºçš„ URL æ¨¡å¼åŒ¹é…
- âœ… **è§’è‰²é©—è­‰**: åŸºæ–¼è§’è‰²çš„è¨ªå•æ§åˆ¶ (RBAC)
- âœ… **é»˜èªæ‹’çµ•**: æœªæ˜ç¢ºæˆæ¬Šçš„è³‡æºé»˜èªæ‹’çµ•è¨ªå•

---

### 2. CSRF é˜²è­·æ©Ÿåˆ¶
**å®‰å…¨æŒ‡æ•¸**: â­â­â­â­ (89/100)

#### ğŸ¯ åŠŸèƒ½ç”¨é€”
- **è·¨ç«™æ”»æ“Šé˜²è­·**: é˜²æ­¢è·¨ç«™è«‹æ±‚å½é€ æ”»æ“Š
- **ç‹€æ…‹æ”¹è®Šä¿è­·**: ä¿è­· POST/PUT/DELETE ç­‰ç‹€æ…‹æ”¹è®Šæ“ä½œ
- **æ™ºèƒ½è±å…**: ç‚º API ç«¯é»æä¾›åˆç†çš„è±å…æ©Ÿåˆ¶
- **ç”¨æˆ¶é«”é©—**: åœ¨å®‰å…¨å’Œå¯ç”¨æ€§ä¹‹é–“å–å¾—å¹³è¡¡

#### âš™ï¸ æŠ€è¡“å¯¦ç¾
```java
.csrf(csrf -> {
    csrf.csrfTokenRepository(CookieCsrfTokenRepository.withHttpOnlyFalse())
        .ignoringRequestMatchers(
            "/api/**",           // API ç«¯é»ä½¿ç”¨ JWTï¼Œä¸éœ€è¦ CSRF
            "/userlogin",        // ç™»å…¥ç«¯é»
            "/register",         // è¨»å†Šç«¯é»
            "/api/auth/**",      // JWT èªè­‰ç«¯é»
            "/api/pay/**",       // æ”¯ä»˜å›èª¿ç«¯é»
            "/carts/**"          // è³¼ç‰©è»Šç«¯é»ï¼ˆSession èªè­‰ï¼‰
        );
})
```

#### ğŸ›¡ï¸ å®‰å…¨ç‰¹æ€§
- âœ… **Token é©—è­‰**: é›™é‡æäº¤æ¨¡å¼é©—è­‰ CSRF Token
- âœ… **Cookie å­˜å„²**: ä½¿ç”¨ HttpOnly Cookie å­˜å„² Token
- âœ… **æ™ºèƒ½è±å…**: API ç«¯é»ä½¿ç”¨ JWTï¼Œè±å… CSRF æª¢æŸ¥
- âœ… **SameSite ä¿è­·**: çµåˆ SameSite Cookie å±¬æ€§å¢å¼·é˜²è­·

---

## ğŸ” å¯†ç¢¼èˆ‡åŠ å¯†å®‰å…¨

### 1. å¯†ç¢¼å®‰å…¨ç­–ç•¥
**å®‰å…¨æŒ‡æ•¸**: â­â­â­â­â­ (97/100)

#### ğŸ¯ åŠŸèƒ½ç”¨é€”
- **å¯†ç¢¼ä¿è­·**: é˜²æ­¢å¯†ç¢¼æ˜æ–‡å­˜å„²å’Œå½©è™¹è¡¨æ”»æ“Š
- **æš´åŠ›ç ´è§£é˜²è­·**: é«˜è¨ˆç®—æˆæœ¬å»¶ç·©æš´åŠ›ç ´è§£æ”»æ“Š
- **åˆè¦æ¨™æº–**: ç¬¦åˆ OWASP å¯†ç¢¼å­˜å„²æŒ‡å—
- **å‘å‰å…¼å®¹**: æ”¯æ´æœªä¾†æ›´å¼·çš„åŠ å¯†ç®—æ³•å‡ç´š

#### âš™ï¸ æŠ€è¡“å¯¦ç¾
```java
@Bean
public PasswordEncoder passwordEncoder() {
    return new BCryptPasswordEncoder(12); // å¼·åº¦ä¿‚æ•¸ 12
}

// å¯†ç¢¼é©—è­‰ç¤ºä¾‹
@Service
public class UserService {
    
    public boolean validatePassword(String rawPassword, String encodedPassword) {
        return passwordEncoder.matches(rawPassword, encodedPassword);
    }
    
    public String encodePassword(String rawPassword) {
        return passwordEncoder.encode(rawPassword);
    }
}
```

#### ğŸ›¡ï¸ å®‰å…¨ç‰¹æ€§
- âœ… **BCrypt ç®—æ³•**: æ¥­ç•Œæ¨™æº–çš„å¯†ç¢¼å“ˆå¸Œç®—æ³•
- âœ… **è‡ªé©æ‡‰æˆæœ¬**: å¼·åº¦ä¿‚æ•¸ 12ï¼Œç´„ 4096 è¼ªè¿­ä»£
- âœ… **éš¨æ©Ÿé¹½å€¼**: æ¯å€‹å¯†ç¢¼ä½¿ç”¨å”¯ä¸€çš„éš¨æ©Ÿé¹½å€¼
- âœ… **æ™‚é–“ç©©å®š**: é˜²æ­¢æ™‚åºæ”»æ“Šçš„æ¯”è¼ƒæ–¹æ³•

#### ğŸ“ˆ å®‰å…¨è©•åˆ†ç´°é …
| å®‰å…¨é …ç›® | è©•åˆ† | èªªæ˜ |
|---------|------|------|
| ç®—æ³•å¼·åº¦ | 98/100 | BCrypt æ˜¯æ¥­ç•Œæ¨è–¦æ¨™æº– |
| é¹½å€¼éš¨æ©Ÿæ€§ | 95/100 | 128ä½éš¨æ©Ÿé¹½å€¼ |
| è¨ˆç®—æˆæœ¬ | 96/100 | å¼·åº¦ä¿‚æ•¸ 12ï¼Œè¨ˆç®—æˆæœ¬é«˜ |
| æŠ—æ”»æ“Šæ€§ | 98/100 | æŠ—å½©è™¹è¡¨å’Œæš´åŠ›ç ´è§£ |

---

### 2. æ•æ„Ÿé…ç½®åŠ å¯†
**å®‰å…¨æŒ‡æ•¸**: â­â­â­â­ (86/100)

#### ğŸ¯ åŠŸèƒ½ç”¨é€”
- **é…ç½®å®‰å…¨**: ä¿è­·æ•¸æ“šåº«å¯†ç¢¼ã€API å¯†é‘°ç­‰æ•æ„Ÿé…ç½®
- **ç’°å¢ƒéš”é›¢**: é–‹ç™¼ã€æ¸¬è©¦ã€ç”Ÿç”¢ç’°å¢ƒçš„é…ç½®å®‰å…¨éš”é›¢
- **åˆè¦è¦æ±‚**: æ»¿è¶³ä¼æ¥­å®‰å…¨å’Œåˆè¦å¯©è¨ˆè¦æ±‚
- **é‹ç¶­å®‰å…¨**: é˜²æ­¢é…ç½®æ–‡ä»¶æ´©éœ²å°è‡´çš„å®‰å…¨é¢¨éšª

#### âš™ï¸ æŠ€è¡“å¯¦ç¾
```properties
# ä½¿ç”¨ Jasypt åŠ å¯†æ•æ„Ÿé…ç½®
spring.datasource.password=ENC(encrypted_database_password_here)
jwt.secret=ENC(encrypted_jwt_secret_key_here)
redis.password=ENC(encrypted_redis_password_here)

# åŠ å¯†é…ç½®
jasypt.encryptor.algorithm=PBEWithMD5AndDES
jasypt.encryptor.password=${JASYPT_PASSWORD:default_password}
```

#### ğŸ›¡ï¸ å®‰å…¨ç‰¹æ€§
- âœ… **é€æ˜è§£å¯†**: æ‡‰ç”¨å•Ÿå‹•æ™‚è‡ªå‹•è§£å¯†é…ç½®
- âœ… **ç’°å¢ƒè®Šé‡**: åŠ å¯†å¯†é‘°é€šéç’°å¢ƒè®Šé‡æ³¨å…¥
- âœ… **å¤šç®—æ³•æ”¯æ´**: æ”¯æ´ AESã€DES ç­‰å¤šç¨®åŠ å¯†ç®—æ³•
- âœ… **ç”Ÿå‘½é€±æœŸä¿è­·**: å¾é…ç½®åˆ°é‹è¡Œæ™‚çš„å…¨ç¨‹ä¿è­·

---

## ğŸŒ ç¶²è·¯èˆ‡å‚³è¼¸å®‰å…¨

### 1. HTTPS å¼·åˆ¶èˆ‡ HSTS
**å®‰å…¨æŒ‡æ•¸**: â­â­â­â­â­ (93/100)

#### ğŸ¯ åŠŸèƒ½ç”¨é€”
- **å‚³è¼¸åŠ å¯†**: ä¿è­·å®¢æˆ¶ç«¯èˆ‡æœå‹™å™¨é–“çš„æ•¸æ“šå‚³è¼¸
- **ä¸­é–“äººæ”»æ“Šé˜²è­·**: é˜²æ­¢ç¶²è·¯å±¤çš„æ”»æ“Šå’Œç«Šè½
- **ç€è¦½å™¨å¼·åˆ¶**: é€šé HSTS å¼·åˆ¶ç€è¦½å™¨ä½¿ç”¨ HTTPS
- **SEO å’Œä¿¡ä»»**: æå‡æœç´¢å¼•æ“æ’åå’Œç”¨æˆ¶ä¿¡ä»»åº¦

#### âš™ï¸ æŠ€è¡“å¯¦ç¾
```java
.headers(headers -> {
    headers.httpStrictTransportSecurity(hstsConfig -> 
        hstsConfig.maxAgeInSeconds(31536000) // 1 å¹´
                  .includeSubDomains(true)    // åŒ…å«å­åŸŸå
                  .preload(true)              // æ”¯æ´é è¼‰å…¥
    );
})
```

#### ğŸ›¡ï¸ å®‰å…¨ç‰¹æ€§
- âœ… **TLS 1.3**: ä½¿ç”¨æœ€æ–°çš„ TLS å”è­°ç‰ˆæœ¬
- âœ… **å®Œç¾å‰å‘ä¿å¯†**: å³ä½¿ç§é‘°æ´©éœ²ä¹Ÿç„¡æ³•è§£å¯†æ­·å²é€šä¿¡
- âœ… **HSTS é è¼‰å…¥**: åŠ å…¥ç€è¦½å™¨ HSTS é è¼‰å…¥åˆ—è¡¨
- âœ… **å­åŸŸåä¿è­·**: ä¿è­·æ‰€æœ‰å­åŸŸåçš„é€šä¿¡å®‰å…¨

---

### 2. å®‰å…¨æ¨™é ­ç­–ç•¥
**å®‰å…¨æŒ‡æ•¸**: â­â­â­â­ (90/100)

#### ğŸ¯ åŠŸèƒ½ç”¨é€”
- **å¤šå±¤é˜²è­·**: åœ¨ HTTP å±¤é¢å¢åŠ å¤šé‡å®‰å…¨é˜²è­·
- **æ”»æ“Šç·©è§£**: ç·©è§£ XSSã€é»æ“ŠåŠ«æŒã€MIME å—…æ¢ç­‰æ”»æ“Š
- **ç€è¦½å™¨å”ä½œ**: åˆ©ç”¨ç¾ä»£ç€è¦½å™¨çš„å®‰å…¨ç‰¹æ€§
- **åˆè¦æ¨™æº–**: ç¬¦åˆ OWASP å’Œæ¥­ç•Œå®‰å…¨æ¨™æº–

#### âš™ï¸ æŠ€è¡“å¯¦ç¾
```java
.headers(headers -> {
    headers
        // é˜²æ­¢é»æ“ŠåŠ«æŒ
        .frameOptions(frameOptions -> frameOptions.deny())
        
        // é˜²æ­¢ MIME é¡å‹æ··æ·†
        .contentTypeOptions(Customizer.withDefaults())
        
        // XSS ä¿è­·
        .addHeaderWriter((request, response) -> {
            response.addHeader("X-XSS-Protection", "1; mode=block");
        })
        
        // å…§å®¹å®‰å…¨ç­–ç•¥
        .addHeaderWriter((request, response) -> {
            response.addHeader("Content-Security-Policy", 
                "default-src 'self'; " +
                "script-src 'self' 'unsafe-inline' cdn.jsdelivr.net; " +
                "style-src 'self' 'unsafe-inline' cdn.jsdelivr.net; " +
                "img-src 'self' data:; " +
                "font-src 'self' cdn.jsdelivr.net;");
        });
})
```

#### ğŸ›¡ï¸ å®‰å…¨ç‰¹æ€§
- âœ… **X-Frame-Options**: é˜²æ­¢ç¶²é è¢«åµŒå…¥åˆ°æƒ¡æ„æ¡†æ¶ä¸­
- âœ… **X-Content-Type-Options**: é˜²æ­¢ç€è¦½å™¨ MIME å—…æ¢æ”»æ“Š
- âœ… **X-XSS-Protection**: å•Ÿç”¨ç€è¦½å™¨å…§å»ºçš„ XSS éæ¿¾å™¨
- âœ… **Content-Security-Policy**: é™åˆ¶è³‡æºè¼‰å…¥ä¾†æºï¼Œé˜²æ­¢ XSS æ”»æ“Š
- âœ… **Referrer-Policy**: æ§åˆ¶ HTTP Referrer è³‡è¨Šçš„æ´©éœ²
- âœ… **Permissions-Policy**: é™åˆ¶ç€è¦½å™¨ API çš„ä½¿ç”¨æ¬Šé™

#### ğŸ“ˆ å®‰å…¨æ¨™é ­è©•åˆ†
| å®‰å…¨æ¨™é ­ | è©•åˆ† | é˜²è­·æ•ˆæœ |
|----------|------|----------|
| X-Frame-Options | 95/100 | å®Œå…¨é˜²æ­¢é»æ“ŠåŠ«æŒ |
| CSP | 88/100 | æœ‰æ•ˆé˜²æ­¢ XSS æ”»æ“Š |
| X-Content-Type-Options | 92/100 | é˜²æ­¢ MIME å—…æ¢ |
| HSTS | 95/100 | å¼·åˆ¶ HTTPS é€£æ¥ |
| Referrer-Policy | 85/100 | æ§åˆ¶è³‡è¨Šæ´©éœ² |

---

### 3. CORS è·¨åŸŸå®‰å…¨
**å®‰å…¨æŒ‡æ•¸**: â­â­â­â­ (87/100)

#### ğŸ¯ åŠŸèƒ½ç”¨é€”
- **è·¨åŸŸæ§åˆ¶**: ç²¾ç¢ºæ§åˆ¶å“ªäº›åŸŸåå¯ä»¥è¨ªå• API
- **é æª¢å„ªåŒ–**: æ¸›å°‘ä¸å¿…è¦çš„é æª¢è«‹æ±‚ï¼Œæå‡æ€§èƒ½
- **å®‰å…¨é‚Šç•Œ**: åœ¨ç€è¦½å™¨å±¤é¢å»ºç«‹å®‰å…¨é‚Šç•Œ
- **é–‹ç™¼æ”¯æ´**: æ”¯æ´å‰å¾Œç«¯åˆ†é›¢çš„é–‹ç™¼æ¨¡å¼

#### âš™ï¸ æŠ€è¡“å¯¦ç¾
```java
@Bean
public CorsConfigurationSource corsConfigurationSource() {
    CorsConfiguration configuration = new CorsConfiguration();
    
    // å…è¨±çš„ä¾†æº
    configuration.setAllowedOrigins(Arrays.asList(
        "http://localhost:3000",  // React é–‹ç™¼æœå‹™å™¨
        "http://localhost:8080",  // æœ¬åœ°æ¸¬è©¦
        "https://yourdomain.com"  // ç”Ÿç”¢ç’°å¢ƒ
    ));
    
    // å…è¨±çš„ HTTP æ–¹æ³•
    configuration.setAllowedMethods(Arrays.asList(
        "GET", "POST", "PUT", "DELETE", "OPTIONS"
    ));
    
    // å…è¨±çš„æ¨™é ­
    configuration.setAllowedHeaders(Arrays.asList("*"));
    
    // å…è¨±æ†‘è­‰
    configuration.setAllowCredentials(true);
    
    // é æª¢å¿«å–æ™‚é–“
    configuration.setMaxAge(3600L);
    
    UrlBasedCorsConfigurationSource source = new UrlBasedCorsConfigurationSource();
    source.registerCorsConfiguration("/**", configuration);
    return source;
}
```

#### ğŸ›¡ï¸ å®‰å…¨ç‰¹æ€§
- âœ… **ä¾†æºç™½åå–®**: åªå…è¨±ä¿¡ä»»çš„åŸŸåè·¨åŸŸè¨ªå•
- âœ… **æ–¹æ³•é™åˆ¶**: é™åˆ¶å…è¨±çš„ HTTP æ–¹æ³•é¡å‹
- âœ… **æ†‘è­‰æ”¯æ´**: å®‰å…¨åœ°è™•ç†å¸¶æ†‘è­‰çš„è·¨åŸŸè«‹æ±‚
- âœ… **é æª¢å¿«å–**: æ¸›å°‘ç¶²è·¯é–‹éŠ·ï¼Œæå‡ç”¨æˆ¶é«”é©—

---

## ğŸ“Š å®‰å…¨ç›£æ§èˆ‡å¯©è¨ˆ

### 1. å®‰å…¨äº‹ä»¶æ—¥èªŒ
**å®‰å…¨æŒ‡æ•¸**: â­â­â­â­ (84/100)

#### ğŸ¯ åŠŸèƒ½ç”¨é€”
- **å¨è„…æª¢æ¸¬**: åŠæ™‚ç™¼ç¾æ½›åœ¨çš„å®‰å…¨å¨è„…å’Œæ”»æ“Š
- **äº‹ä»¶è¿½è¹¤**: å®Œæ•´è¨˜éŒ„ç”¨æˆ¶è¡Œç‚ºå’Œç³»çµ±äº‹ä»¶
- **åˆè¦å¯©è¨ˆ**: æ»¿è¶³å®‰å…¨åˆè¦å’Œå¯©è¨ˆè¦æ±‚
- **äº‹ä»¶éŸ¿æ‡‰**: ç‚ºå®‰å…¨äº‹ä»¶éŸ¿æ‡‰æä¾›è©³ç´°çš„ä¸Šä¸‹æ–‡ä¿¡æ¯

#### âš™ï¸ æŠ€è¡“å¯¦ç¾
```java
// èªè­‰å¤±æ•—æ—¥èªŒ
@Component
public class SecurityEventLogger {
    
    private static final Logger securityLogger = LoggerFactory.getLogger("SECURITY");
    
    public void logAuthenticationFailure(String username, String ip, String uri, String error) {
        securityLogger.warn("èªè­‰å¤±æ•— - ç”¨æˆ¶: {}, IP: {}, URI: {}, éŒ¯èª¤: {}", 
                           username, ip, uri, error);
    }
    
    public void logTokenBlacklisted(String username, String ip, String jti) {
        securityLogger.warn("Token è¢«åŠ å…¥é»‘åå–® - ç”¨æˆ¶: {}, IP: {}, JTI: {}", 
                           username, ip, jti);
    }
    
    public void logSuspiciousActivity(String username, String ip, String activity) {
        securityLogger.error("æª¢æ¸¬åˆ°å¯ç–‘æ´»å‹• - ç”¨æˆ¶: {}, IP: {}, æ´»å‹•: {}", 
                            username, ip, activity);
    }
}
```

#### ğŸ›¡ï¸ å®‰å…¨ç‰¹æ€§
- âœ… **çµæ§‹åŒ–æ—¥èªŒ**: ä½¿ç”¨ JSON æ ¼å¼ä¾¿æ–¼è‡ªå‹•åŒ–åˆ†æ
- âœ… **æ•æ„Ÿè³‡è¨Šè„«æ•**: é¿å…è¨˜éŒ„å¯†ç¢¼ç­‰æ•æ„Ÿè³‡è¨Š
- âœ… **å¤šç´šåˆ¥è¨˜éŒ„**: å€åˆ† INFOã€WARNã€ERROR ç­‰ä¸åŒç´šåˆ¥
- âœ… **å¯¦æ™‚ç›£æ§**: æ”¯æ´å¯¦æ™‚æ—¥èªŒæµè™•ç†å’Œå‘Šè­¦

---

### 2. æ•ˆèƒ½èˆ‡å¥åº·ç›£æ§
**å®‰å…¨æŒ‡æ•¸**: â­â­â­ (78/100)

#### ğŸ¯ åŠŸèƒ½ç”¨é€”
- **ç³»çµ±å¥åº·**: ç›£æ§æ‡‰ç”¨ç¨‹å¼å’Œä¾è³´æœå‹™çš„å¥åº·ç‹€æ…‹
- **æ•ˆèƒ½æŒ‡æ¨™**: è¿½è¹¤é—œéµæ•ˆèƒ½æŒ‡æ¨™å’Œè¶¨å‹¢
- **è³‡æºç›£æ§**: ç›£æ§ CPUã€è¨˜æ†¶é«”ã€é€£æ¥æ± ç­‰è³‡æºä½¿ç”¨
- **é è­¦ç³»çµ±**: åœ¨å•é¡Œç™¼ç”Ÿå‰æä¾›é è­¦

#### âš™ï¸ æŠ€è¡“å¯¦ç¾
```properties
# Actuator ç›£æ§é…ç½®
management.endpoints.web.exposure.include=health,info,metrics,prometheus
management.endpoint.health.show-details=always
management.server.port=9090

# è‡ªå®šç¾©å¥åº·æª¢æŸ¥
management.endpoint.health.group.custom.include=db,redis,diskSpace
```

#### ğŸ›¡ï¸ ç›£æ§ç‰¹æ€§
- âœ… **å¤šç¶­åº¦ç›£æ§**: æ¶µè“‹æ‡‰ç”¨ã€æ•¸æ“šåº«ã€Redisã€ç£ç¢Ÿç­‰
- âœ… **Prometheus é›†æˆ**: æ”¯æ´ç¾ä»£ç›£æ§å †ç–Š
- âœ… **è‡ªå‹•ç™¼ç¾**: è‡ªå‹•ç™¼ç¾ä¸¦ç›£æ§ Spring Boot å…ƒä»¶
- âœ… **å‘Šè­¦é›†æˆ**: å¯èˆ‡ Grafanaã€AlertManager é›†æˆ

---

## ğŸ“ˆ æ•´é«”å®‰å…¨è©•åˆ†

### ğŸ† ç¸½é«”å®‰å…¨æŒ‡æ•¸: 91/100 (å„ªç§€ç´š)

#### ğŸ“Š å„æ¨¡çµ„è©³ç´°è©•åˆ†
| å®‰å…¨æ¨¡çµ„ | æ¬Šé‡ | è©•åˆ† | åŠ æ¬Šåˆ†æ•¸ | ç´šåˆ¥ |
|---------|------|------|----------|------|
| **èªè­‰ç³»çµ±** | 25% | 94/100 | 23.5 | ğŸ† å„ªç§€ |
| **æˆæ¬Šæ§åˆ¶** | 20% | 91/100 | 18.2 | ğŸ† å„ªç§€ |
| **æ•¸æ“šä¿è­·** | 20% | 90/100 | 18.0 | ğŸ† å„ªç§€ |
| **ç¶²è·¯å®‰å…¨** | 20% | 90/100 | 18.0 | ğŸ† å„ªç§€ |
| **å®‰å…¨ç›£æ§** | 15% | 81/100 | 12.2 | ğŸ¥‡ è‰¯å¥½ |
| **ç¸½åˆ†** | 100% | - | **89.9** | ğŸ† å„ªç§€ |

#### ğŸ¯ å®‰å…¨å„ªå‹¢åˆ†æ
```
âœ… ä¼æ¥­ç´šèªè­‰æ¶æ§‹ (JWT + Session æ··åˆ)
âœ… å¤šå±¤å®‰å…¨é˜²è­·é«”ç³» (7å±¤é˜²è­·)
âœ… ç¾ä»£å®‰å…¨æ¨™æº–åˆè¦ (OWASP TOP 10)
âœ… é«˜æ€§èƒ½å®‰å…¨è¨­è¨ˆ (Redis ç·©å­˜å„ªåŒ–)
âœ… å¯æ“´å±•å®‰å…¨æ¶æ§‹ (å¾®æœå‹™å‹å¥½)
```

#### ğŸ”§ æ”¹é€²å»ºè­°
```
ğŸ”„ å¢å¼·å¨è„…æª¢æ¸¬èƒ½åŠ› (AI ç•°å¸¸æª¢æ¸¬)
ğŸ”„ å®Œå–„è‡ªå‹•åŒ–éŸ¿æ‡‰ (è‡ªå‹•å°ç¦æ©Ÿåˆ¶)  
ğŸ”„ æ“´å±•å¯©è¨ˆåŠŸèƒ½ (ç”¨æˆ¶è¡Œç‚ºåˆ†æ)
ğŸ”„ å¼·åŒ– API å®‰å…¨ (Rate Limiting)
ğŸ”„ å¢åŠ  2FA æ”¯æ´ (å¤šå› ç´ èªè­‰)
```

---

## ğŸš€ éƒ¨ç½²èˆ‡ç¶­è­·

### ç”Ÿç”¢ç’°å¢ƒå®‰å…¨æ¸…å–®
- [ ] **ç’°å¢ƒè®Šæ•¸**: æ‰€æœ‰æ•æ„Ÿé…ç½®ä½¿ç”¨ç’°å¢ƒè®Šæ•¸
- [ ] **HTTPS è­‰æ›¸**: éƒ¨ç½²æœ‰æ•ˆçš„ SSL/TLS è­‰æ›¸
- [ ] **é˜²ç«ç‰†è¦å‰‡**: é…ç½®é©ç•¶çš„ç¶²è·¯è¨ªå•æ§åˆ¶
- [ ] **å®šæœŸæ›´æ–°**: å»ºç«‹ä¾è³´å¥—ä»¶å®šæœŸæ›´æ–°æ©Ÿåˆ¶
- [ ] **å®‰å…¨æƒæ**: é€²è¡Œå®šæœŸçš„å®‰å…¨æ¼æ´æƒæ
- [ ] **å‚™ä»½ç­–ç•¥**: å»ºç«‹æ•¸æ“šå‚™ä»½å’Œç½é›£æ¢å¾©è¨ˆåŠƒ
- [ ] **ç›£æ§å‘Šè­¦**: é…ç½® 24/7 å®‰å…¨ç›£æ§å’Œå‘Šè­¦
- [ ] **äº‹ä»¶éŸ¿æ‡‰**: åˆ¶å®šå®‰å…¨äº‹ä»¶éŸ¿æ‡‰æµç¨‹

### å®‰å…¨ç¶­è­·é€±æœŸ
| é …ç›® | é »ç‡ | è²¬ä»»æ–¹ |
|------|------|---------|
| å®‰å…¨æ¼æ´æƒæ | æ¯é€± | DevSecOps åœ˜éšŠ |
| ä¾è³´å¥—ä»¶æ›´æ–° | æ¯æœˆ | é–‹ç™¼åœ˜éšŠ |
| å®‰å…¨é…ç½®å¯©æŸ¥ | æ¯å­£ | å®‰å…¨åœ˜éšŠ |
| æ»²é€æ¸¬è©¦ | æ¯å¹´ | ç¬¬ä¸‰æ–¹å®‰å…¨å…¬å¸ |
| äº‹ä»¶éŸ¿æ‡‰æ¼”ç·´ | æ¯å¹´ | å…¨é«”åœ˜éšŠ |

---

## ğŸ“š åƒè€ƒè³‡æ–™

### ğŸ”— å®‰å…¨æ¨™æº–èˆ‡æŒ‡å—
- [OWASP Top 10](https://owasp.org/www-project-top-ten/)
- [Spring Security Reference](https://docs.spring.io/spring-security/reference/)
- [JWT Best Practices](https://tools.ietf.org/html/rfc8725)
- [NIST Cybersecurity Framework](https://www.nist.gov/cyberframework)

### ğŸ“– æ¨è–¦é–±è®€
- ã€ŠWeb Application Securityã€‹- Andrew Hoffman
- ã€ŠSpring Security in Actionã€‹- Laurentiu Spilca  
- ã€ŠOAuth 2 in Actionã€‹- Justin Richer
- ã€ŠThe Web Application Hacker's Handbookã€‹- Dafydd Stuttard

---

*æœ¬æ–‡æª”ç‰ˆæœ¬*: **v2.0**  
*æœ€å¾Œæ›´æ–°*: **2025å¹´11æœˆ6æ—¥**  
*ç¶­è­·åœ˜éšŠ*: **å®‰å…¨é–‹ç™¼åœ˜éšŠ**  
*ä¸‹æ¬¡å¯©æŸ¥*: **2025å¹´12æœˆ6æ—¥**